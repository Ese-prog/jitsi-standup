(this["webpackJsonpjitsi-standup"]=this["webpackJsonpjitsi-standup"]||[]).push([[0],{47:function(e,t,n){e.exports=n(58)},52:function(e,t,n){},54:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7),o=n.n(c),i=(n(52),n(41)),u=n(16),s=n(13),l=n.n(s),d=n(25),f=(n(54),n(36)),m=n.n(f),h=n(42),p=function(e){var t=e.vertical,n=e.horizontal,a=e.size,c=Object(h.a)(e,["vertical","horizontal","size"]);return r.a.createElement("div",Object.assign({style:{position:"absolute",display:"flex",height:a,width:a,borderRadius:a,overflow:"hidden",justifyContent:"center",top:"calc(50% - ".concat(a,"px/2  + ").concat(t,"%)"),left:"calc(50% - ".concat(a,"px/2 + ").concat(n,"%)")}},c))},v=function(e){var t=Math.min(window.innerHeight,window.innerWidth);switch(e){case 0:return 0;case 1:return t;case 2:return t/2;case 3:return t/(1+2/Math.sqrt(3));case 4:return t/(1+Math.sqrt(2));case 5:return t/(1+Math.sqrt(2*(1+1/Math.sqrt(5))));case 6:return t/3;case 7:default:return t/4}},b=function(e){var t,n=e.track,a=e.index,c=e.length,o=v(c),i=(t=c)<2?0:50-v(t)/2/Math.min(window.innerHeight,window.innerWidth)*100,u=360/c*a,s=Math.cos(2*u*Math.PI/360)*i,l=Math.sin(2*u*Math.PI/360)*i;return r.a.createElement(p,{size:o,horizontal:s,vertical:l},r.a.createElement("video",{height:o,style:{flexShrink:0},autoPlay:"1",key:"track_".concat(n.getId()),ref:function(e){return e&&n.attach(e)}}))},g=n(88),E=n(89),O=function(e){return Object(a.useCallback)((function(t){return e(t.target.value)}),[e])},w=function(e){var t=e.connect,n=e.room,a=e.domain,c=e.setDomain,o=e.setRoom,i=O(c),u=O(o);return r.a.createElement("form",{noValidate:!0,autoComplete:"off",onSubmit:t},r.a.createElement(g.a,{label:"Jitsi instance",placeholder:"https://meet.jit.si",value:a,onChange:i}),r.a.createElement("br",null),r.a.createElement(g.a,{label:"room name",value:n,placeholder:"daily standup",onChange:u}),r.a.createElement("br",null),r.a.createElement(E.a,{type:"submit",color:"primary"},"Join"))},j=function(e){var t=e.track;e.index;return t&&t.isLocal()?null:r.a.createElement("audio",{autoPlay:"1",ref:function(e){return e&&t.attach(e)}})};window.$=m.a;var k=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.domain,n=t.room,a=t.config,r=Object.assign({},a),c=r.websocket||r.bosh,c+="?room=".concat(n),r.serviceUrl=r.bosh=c,e.abrupt("return",new Promise((function(e,t){var n=new JitsiMeetJS.JitsiConnection(null,void 0,r);console.log("JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED",JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED),n.addEventListener(JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED,(function(){return e(n)})),n.addEventListener(JitsiMeetJS.events.connection.CONNECTION_FAILED,t),n.connect()})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.connection,a=t.room,r=n.initJitsiConference(a,{}),e.abrupt("return",new Promise((function(e){r.on(JitsiMeetJS.events.conference.CONFERENCE_JOINED,(function(){return e(r)})),r.join()})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r,c,o,i,u,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.domain,a=t.room,r=t.config,e.next=3,k({domain:n,room:a,config:r});case 3:return c=e.sent,e.next=6,JitsiMeetJS.createLocalTracks({devices:["video","audio"],facingMode:"user"},!0);case 6:return o=e.sent,e.next=9,y({connection:c,room:a});case 9:return i=e.sent,u=o.find((function(e){return"video"===e.getType()})),i.addTrack(u),s=o.find((function(e){return"audio"===e.getType()})),i.addTrack(s),e.abrupt("return",{connection:c,conference:i,localTrack:u});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){var t=e.domain,n=e.room;return new Promise((function(e){var a=document.createElement("script");a.onload=function(){JitsiMeetJS.init();var a=document.createElement("script");a.src="https://".concat(t,"/config.js"),document.querySelector("head").appendChild(a),a.onload=function(){J({domain:t,room:n,config:config}).then(e)}},a.src="https://".concat(t,"/libs/lib-jitsi-meet.min.js"),document.querySelector("head").appendChild(a)}))},S=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useCallback)((function(e){r((function(t){return t.find((function(t){return e.getId()===t.getId()}))?t:[].concat(Object(i.a)(t),[e])}))}),[r]),o=Object(a.useCallback)((function(e){r((function(t){return t.filter((function(t){return e.getId()!==t.getId()}))}))}),[r]);return[n,c,o]};var M=function(){var e=Object(a.useState)("init"),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)("meet.jit.si"),i=Object(u.a)(o,2),s=i[0],f=i[1],m=Object(a.useState)("max_daily_standup"),h=Object(u.a)(m,2),p=h[0],v=h[1],g=Object(a.useState)(null),E=Object(u.a)(g,2),O=E[0],k=E[1],y=S(),J=Object(u.a)(y,3),M=J[0],x=J[1],T=J[2],I=S(),N=Object(u.a)(I,3),D=N[0],_=N[1],A=N[2],L=Object(a.useCallback)((function(e){"video"===e.getType()&&x(e),"audio"===e.getType()&&_(e)}),[x,_]),R=Object(a.useCallback)((function(e){"video"===e.getType()&&T(e),"audio"===e.getType()&&A(e)}),[A,T]),P=Object(a.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),c("loading"),e.next=4,C({domain:s,room:p});case 4:n=e.sent,n.connection,a=n.conference,r=n.localTrack,c("started"),k(a),L(r);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[L,s,p]);return Object(a.useEffect)((function(){O&&(O.on(JitsiMeetJS.events.conference.TRACK_ADDED,L),O.on(JitsiMeetJS.events.conference.TRACK_REMOVED,R))}),[L,O,R]),r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},"init"===n&&r.a.createElement(w,{connect:P,domain:s,room:p,setRoom:v,setDomain:f}),"loading"===n&&"Loading","started"===n&&r.a.createElement("div",{style:{height:"100vh",width:"100vw",maxHeight:"100vw",maxWidth:"100vh",background:"rgba(0, 100,100, 1)",position:"relative",borderRadius:"100%"}},M.map((function(e,t){return r.a.createElement(b,{track:e,index:t,length:M.length,key:e.getId()})})),D.map((function(e,t){return r.a.createElement(j,{track:e,index:t,key:e.getId()})})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[47,1,2]]]);
//# sourceMappingURL=main.7e8f5949.chunk.js.map