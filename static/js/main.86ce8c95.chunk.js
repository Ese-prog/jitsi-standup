(this["webpackJsonpjitsi-standup"]=this["webpackJsonpjitsi-standup"]||[]).push([[0],{47:function(e,t,n){e.exports=n(58)},52:function(e,t,n){},54:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(7),o=n.n(c),i=(n(52),n(41)),s=n(22),u=n(13),l=n.n(u),d=n(25),f=(n(54),n(36)),m=n.n(f),h=n(42),p=function(e){var t=e.vertical,n=e.horizontal,r=e.size,c=Object(h.a)(e,["vertical","horizontal","size"]);return a.a.createElement("div",Object.assign({style:{position:"absolute",display:"flex",height:r,width:r,borderRadius:r,overflow:"hidden",justifyContent:"center",top:"calc(50% - ".concat(r,"px/2  + ").concat(t,"%)"),left:"calc(50% - ".concat(r,"px/2 + ").concat(n,"%)")}},c))},v=function(e){var t=Math.min(window.innerHeight,window.innerWidth);switch(e){case 0:return 0;case 1:return t;case 2:return t/2;case 3:return t/(1+2/Math.sqrt(3));case 4:return t/(1+Math.sqrt(2));case 5:return t/(1+Math.sqrt(2*(1+1/Math.sqrt(5))));case 6:return t/3;case 7:default:return t/4}},b=function(e){var t,n=e.track,r=e.index,c=e.length,o=v(c),i=(t=c)<2?0:50-v(t)/2/Math.min(window.innerHeight,window.innerWidth)*100,s=360/c*r,u=Math.cos(2*s*Math.PI/360)*i,l=Math.sin(2*s*Math.PI/360)*i;return a.a.createElement(p,{size:o,horizontal:u,vertical:l},a.a.createElement("video",{height:o,style:{flexShrink:0},autoPlay:"1",key:"track_".concat(n.getId()),ref:function(e){return e&&n.attach(e)}}))},E=n(88),g=n(89),w=function(e){return Object(r.useCallback)((function(t){return e(t.target.value)}),[e])},O=function(e){var t=e.connect,n=e.room,r=e.domain,c=e.setDomain,o=e.setRoom,i=w(c),s=w(o);return a.a.createElement("form",{noValidate:!0,autoComplete:"off",onSubmit:t},a.a.createElement(E.a,{label:"Jitsi instance",placeholder:"https://meet.jit.si",value:r,onChange:i}),a.a.createElement("br",null),a.a.createElement(E.a,{label:"room name",value:n,placeholder:"daily standup",onChange:s}),a.a.createElement("br",null),a.a.createElement(g.a,{type:"submit",color:"primary"},"Join"))};window.$=m.a;var j=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.domain,n=t.room,r=t.config,a=Object.assign({},r),c=a.websocket||a.bosh,c+="?room=".concat(n),a.serviceUrl=a.bosh=c,e.abrupt("return",new Promise((function(e,t){var n=new JitsiMeetJS.JitsiConnection(null,void 0,a);console.log("JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED",JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED),n.addEventListener(JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED,(function(){return e(n)})),n.addEventListener(JitsiMeetJS.events.connection.CONNECTION_FAILED,t),n.connect()})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.connection,r=t.room,a=n.initJitsiConference(r,{}),e.abrupt("return",new Promise((function(e){a.on(JitsiMeetJS.events.conference.CONFERENCE_JOINED,(function(){return e(a)})),a.join()})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a,c,o,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.domain,r=t.room,a=t.config,e.next=3,j({domain:n,room:r,config:a});case 3:return c=e.sent,e.next=6,JitsiMeetJS.createLocalTracks({devices:["video"],facingMode:"user"},!0);case 6:return o=e.sent,e.next=9,J({connection:c,room:r});case 9:return i=e.sent,s=o.find((function(e){return"video"===e.getType()})),i.addTrack(s),e.abrupt("return",{connection:c,conference:i,localTrack:s});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){var t=e.domain,n=e.room;return new Promise((function(e){var r=document.createElement("script");r.onload=function(){JitsiMeetJS.init();var r=document.createElement("script");r.src="https://".concat(t,"/config.js"),document.querySelector("head").appendChild(r),r.onload=function(){S({domain:t,room:n,config:config}).then(e)}},r.src="https://".concat(t,"/libs/lib-jitsi-meet.min.js"),document.querySelector("head").appendChild(r)}))};var k=function(){var e=Object(r.useState)("init"),t=Object(s.a)(e,2),n=t[0],c=t[1],o=Object(r.useState)("meet.jit.si"),u=Object(s.a)(o,2),f=u[0],m=u[1],h=Object(r.useState)("max_daily_standup"),p=Object(s.a)(h,2),v=p[0],E=p[1],g=Object(r.useState)(null),w=Object(s.a)(g,2),j=w[0],J=w[1],S=Object(r.useState)([]),k=Object(s.a)(S,2),M=k[0],y=k[1],x=Object(r.useCallback)((function(e){y((function(t){return t.find((function(t){return e.getId()===t.getId()}))?t:[].concat(Object(i.a)(t),[e])}))}),[y]),I=Object(r.useCallback)((function(e){y((function(t){return t.filter((function(t){return e.getId()!==t.getId()}))}))}),[y]),N=Object(r.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),c("loading"),e.next=4,C({domain:f,room:v});case 4:n=e.sent,n.connection,r=n.conference,a=n.localTrack,c("started"),J(r),x(a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[x,f,v]);return Object(r.useEffect)((function(){j&&(j.on(JitsiMeetJS.events.conference.TRACK_ADDED,x),j.on(JitsiMeetJS.events.conference.TRACK_REMOVED,I))}),[x,j,I]),a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},"init"===n&&a.a.createElement(O,{connect:N,domain:f,room:v,setRoom:E,setDomain:m}),"loading"===n&&"Loading","started"===n&&a.a.createElement("div",{style:{height:"100vh",width:"100vw",maxHeight:"100vw",maxWidth:"100vh",background:"rgba(0, 100,100, 1)",position:"relative",borderRadius:"100%"}},M.map((function(e,t){return a.a.createElement(b,{track:e,index:t,length:M.length})})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[47,1,2]]]);
//# sourceMappingURL=main.86ce8c95.chunk.js.map