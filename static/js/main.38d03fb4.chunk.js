(this["webpackJsonpjitsi-standup"]=this["webpackJsonpjitsi-standup"]||[]).push([[0],{50:function(e,t,n){e.exports=n(63)},55:function(e,t,n){},57:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),i=n.n(o),c=(n(55),n(44)),u=n(13),s=n(14),l=n.n(s),d=n(25),f=(n(57),n(38)),m=n.n(f),h=n(45),v=function(e){var t=e.vertical,n=e.horizontal,a=e.size,o=Object(h.a)(e,["vertical","horizontal","size"]);return r.a.createElement("div",Object.assign({style:{position:"absolute",display:"flex",height:a,width:a,borderRadius:a,overflow:"hidden",justifyContent:"center",top:"calc(50% - ".concat(a,"px/2  + ").concat(t,"%)"),left:"calc(50% - ".concat(a,"px/2 + ").concat(n,"%)")}},o))},p=function(e){var t=Math.min(window.innerHeight,window.innerWidth);switch(e){case 0:return 0;case 1:return t;case 2:return t/2;case 3:return t/(1+2/Math.sqrt(3));case 4:return t/(1+Math.sqrt(2));case 5:return t/(1+Math.sqrt(2*(1+1/Math.sqrt(5))));case 6:return t/3;case 7:default:return t/4}},b=function(e){var t,n=e.track,a=e.index,o=e.length,i=p(o),c=(t=o)<2?0:50-p(t)/2/Math.min(window.innerHeight,window.innerWidth)*100,u=360/o*a,s=Math.cos(2*u*Math.PI/360)*c,l=Math.sin(2*u*Math.PI/360)*c;return r.a.createElement(v,{size:i,horizontal:s,vertical:l},r.a.createElement("video",{height:i,style:{flexShrink:0},autoPlay:"1",key:"track_".concat(n.getId()),ref:function(e){return e&&n.attach(e)}}))},g=n(93),w=n(94),E=function(e){return Object(a.useCallback)((function(t){return e(t.target.value)}),[e])},O=function(e){var t=e.connect,n=e.room,a=e.domain,o=e.setDomain,i=e.setRoom,c=E(o),u=E(i);return r.a.createElement("form",{noValidate:!0,autoComplete:"off",onSubmit:t},r.a.createElement(g.a,{label:"Jitsi instance",placeholder:"https://meet.jit.si",value:a,onChange:c}),r.a.createElement("br",null),r.a.createElement(g.a,{label:"room name",value:n,placeholder:"daily standup",onChange:u}),r.a.createElement("br",null),r.a.createElement(w.a,{type:"submit",color:"primary"},"Join"))},j=function(e){var t=e.track;e.index;return t&&t.isLocal()?null:r.a.createElement("audio",{autoPlay:"1",ref:function(e){return e&&t.attach(e)}})};var J=function(){var e="object"===typeof window;function t(){return{width:e?window.innerWidth:void 0,height:e?window.innerHeight:void 0}}var n=Object(a.useState)(t),r=Object(u.a)(n,2),o=r[0],i=r[1];return Object(a.useEffect)((function(){if(!e)return!1;function n(){i(t())}return window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}}),[t,e]),o},k=n(43),y=n.n(k);window.$=m.a;var S=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.domain,n=t.room,a=t.config,r=Object.assign({},a),o=r.websocket||r.bosh,0===(o+="?room=".concat(n)).indexOf("//")&&(o="https:".concat(o)),r.serviceUrl=r.bosh=o,e.abrupt("return",new Promise((function(e,t){var n=new JitsiMeetJS.JitsiConnection(null,void 0,r);console.log("JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED",JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED),n.addEventListener(JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED,(function(){return e(n)})),n.addEventListener(JitsiMeetJS.events.connection.CONNECTION_FAILED,t),n.connect()})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.connection,a=t.room,r=n.initJitsiConference(a,{}),e.abrupt("return",new Promise((function(e){r.on(JitsiMeetJS.events.conference.CONFERENCE_JOINED,(function(){return e(r)})),r.join()})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r,o,i,c,u,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.domain,a=t.room,r=t.config,e.next=3,S({domain:n,room:a,config:r});case 3:return o=e.sent,e.next=6,JitsiMeetJS.createLocalTracks({devices:["video","audio"],facingMode:"user"},!0);case 6:return i=e.sent,e.next=9,C({connection:o,room:a});case 9:return c=e.sent,u=i.find((function(e){return"video"===e.getType()})),c.addTrack(u),s=i.find((function(e){return"audio"===e.getType()})),c.addTrack(s),e.abrupt("return",{connection:o,conference:c,localTrack:u});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(e){var t=e.domain,n=e.room;return new Promise((function(e){var a=document.createElement("script");a.onload=function(){JitsiMeetJS.init();var a=document.createElement("script");a.src="https://".concat(t,"/config.js"),document.querySelector("head").appendChild(a),a.onload=function(){M({domain:t,room:n,config:config}).then(e)}},a.src="https://".concat(t,"/libs/lib-jitsi-meet.min.js"),document.querySelector("head").appendChild(a)}))},T=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(a.useCallback)((function(e){r((function(t){return t.find((function(t){return e.getId()===t.getId()}))?t:[].concat(Object(c.a)(t),[e])}))}),[r]),i=Object(a.useCallback)((function(e){r((function(t){return t.filter((function(t){return e.getId()!==t.getId()}))}))}),[r]);return[n,o,i]},I=function(){var e,t,n,a=document.location.search.length>1?y.a.parse(document.location.search.slice(1)):{};return{room:null!==(e=a.room)&&void 0!==e?e:"daily_standup",domain:null!==(t=a.domain)&&void 0!==t?t:"meet.jit.si",autoJoin:null!==(n=a.autojoin)&&void 0!==n&&n}};var N=function(){J();var e=Object(a.useMemo)(I,[]),t=Object(a.useState)("init"),n=Object(u.a)(t,2),o=n[0],i=n[1],c=Object(a.useState)(e.domain),s=Object(u.a)(c,2),f=s[0],m=s[1],h=Object(a.useState)(e.room),v=Object(u.a)(h,2),p=v[0],g=v[1],w=Object(a.useState)(null),E=Object(u.a)(w,2),k=E[0],y=E[1],S=T(),C=Object(u.a)(S,3),M=C[0],N=C[1],D=C[2],L=T(),A=Object(u.a)(L,3),_=A[0],z=A[1],R=A[2],H=Object(a.useCallback)((function(e){"video"===e.getType()&&N(e),"audio"===e.getType()&&z(e)}),[N,z]),P=Object(a.useCallback)((function(e){"video"===e.getType()&&D(e),"audio"===e.getType()&&R(e)}),[R,D]),q=Object(a.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),i("loading"),e.next=4,x({domain:f,room:p});case 4:n=e.sent,n.connection,a=n.conference,r=n.localTrack,i("started"),y(a),H(r);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[H,f,p]);return Object(a.useEffect)((function(){k&&(k.on(JitsiMeetJS.events.conference.TRACK_ADDED,H),k.on(JitsiMeetJS.events.conference.TRACK_REMOVED,P))}),[H,k,P]),Object(a.useEffect)((function(){(e.autoJoin||""===e.autoJoin)&&q()}),[q,e.autoJoin]),r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},"init"===o&&r.a.createElement(O,{connect:q,domain:f,room:p,setRoom:g,setDomain:m}),"loading"===o&&"Loading","started"===o&&r.a.createElement("div",{style:{height:"100vh",width:"100vw",maxHeight:"100vw",maxWidth:"100vh",background:"rgba(0, 100,100, 1)",position:"relative",borderRadius:"100%"}},M.map((function(e,t){return r.a.createElement(b,{track:e,index:t,length:M.length,key:e.getId()})})),_.map((function(e,t){return r.a.createElement(j,{track:e,index:t,key:e.getId()})})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[50,1,2]]]);
//# sourceMappingURL=main.38d03fb4.chunk.js.map