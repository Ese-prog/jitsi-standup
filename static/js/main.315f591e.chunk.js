(this["webpackJsonpjitsi-standup"]=this["webpackJsonpjitsi-standup"]||[]).push([[0],{50:function(e,t,n){e.exports=n(63)},55:function(e,t,n){},57:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(7),i=n.n(o),c=(n(55),n(44)),u=n(13),s=n(14),l=n.n(s),d=n(25),f=(n(57),n(38)),m=n.n(f),h=n(45),v=function(e){var t=e.vertical,n=e.horizontal,r=e.size,o=Object(h.a)(e,["vertical","horizontal","size"]);return a.a.createElement("div",Object.assign({style:{position:"absolute",display:"flex",height:r,width:r,borderRadius:r,overflow:"hidden",justifyContent:"center",top:"calc(50% - ".concat(r,"px/2  + ").concat(t,"%)"),left:"calc(50% - ".concat(r,"px/2 + ").concat(n,"%)")}},o))},p=function(e){var t=Math.min(window.innerHeight,window.innerWidth);switch(e){case 0:return 0;case 1:return t;case 2:return t/2;case 3:return t/(1+2/Math.sqrt(3));case 4:return t/(1+Math.sqrt(2));case 5:return t/(1+Math.sqrt(2*(1+1/Math.sqrt(5))));case 6:return t/3;case 7:default:return t/4}},b=function(e){var t,n=e.track,r=e.index,o=e.length,i=p(o),c=(t=o)<2?0:50-p(t)/2/Math.min(window.innerHeight,window.innerWidth)*100,u=360/o*r,s=Math.cos(2*u*Math.PI/360)*c,l=Math.sin(2*u*Math.PI/360)*c;return a.a.createElement(v,{size:i,horizontal:s,vertical:l},a.a.createElement("video",{height:i,style:{flexShrink:0},autoPlay:"1",key:"track_".concat(n.getId()),ref:function(e){return e&&n.attach(e)}}))},g=n(93),w=n(94),E=function(e){return Object(r.useCallback)((function(t){return e(t.target.value)}),[e])},j=function(e){var t=e.connect,n=e.room,r=e.domain,o=e.setDomain,i=e.setRoom,c=E(o),u=E(i);return a.a.createElement("form",{noValidate:!0,autoComplete:"off",onSubmit:t},a.a.createElement(g.a,{label:"Jitsi instance",placeholder:"https://meet.jit.si",value:r,onChange:c}),a.a.createElement("br",null),a.a.createElement(g.a,{label:"room name",value:n,placeholder:"daily standup",onChange:u}),a.a.createElement("br",null),a.a.createElement(w.a,{type:"submit",color:"primary"},"Join"))},O=function(e){var t=e.track;e.index;return t&&t.isLocal()?null:a.a.createElement("audio",{autoPlay:"1",ref:function(e){return e&&t.attach(e)}})};var J=function(){var e="object"===typeof window;function t(){return{width:e?window.innerWidth:void 0,height:e?window.innerHeight:void 0}}var n=Object(r.useState)(t),a=Object(u.a)(n,2),o=a[0],i=a[1];return Object(r.useEffect)((function(){if(!e)return!1;function n(){i(t())}return window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}}),[t,e]),o},k=n(43),y=n.n(k);window.$=m.a;var S=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.domain,n=t.room,r=t.config,a=Object.assign({},r),o=a.websocket||a.bosh,o+="?room=".concat(n),a.serviceUrl=a.bosh=o,e.abrupt("return",new Promise((function(e,t){var n=new JitsiMeetJS.JitsiConnection(null,void 0,a);console.log("JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED",JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED),n.addEventListener(JitsiMeetJS.events.connection.CONNECTION_ESTABLISHED,(function(){return e(n)})),n.addEventListener(JitsiMeetJS.events.connection.CONNECTION_FAILED,t),n.connect()})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.connection,r=t.room,a=n.initJitsiConference(r,{}),e.abrupt("return",new Promise((function(e){a.on(JitsiMeetJS.events.conference.CONFERENCE_JOINED,(function(){return e(a)})),a.join()})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a,o,i,c,u,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.domain,r=t.room,a=t.config,e.next=3,S({domain:n,room:r,config:a});case 3:return o=e.sent,e.next=6,JitsiMeetJS.createLocalTracks({devices:["video","audio"],facingMode:"user"},!0);case 6:return i=e.sent,e.next=9,C({connection:o,room:r});case 9:return c=e.sent,u=i.find((function(e){return"video"===e.getType()})),c.addTrack(u),s=i.find((function(e){return"audio"===e.getType()})),c.addTrack(s),e.abrupt("return",{connection:o,conference:c,localTrack:u});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){var t=e.domain,n=e.room;return new Promise((function(e){var r=document.createElement("script");r.onload=function(){JitsiMeetJS.init();var r=document.createElement("script");r.src="https://".concat(t,"/config.js"),document.querySelector("head").appendChild(r),r.onload=function(){M({domain:t,room:n,config:config}).then(e)}},r.src="https://".concat(t,"/libs/lib-jitsi-meet.min.js"),document.querySelector("head").appendChild(r)}))},x=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(r.useCallback)((function(e){a((function(t){return t.find((function(t){return e.getId()===t.getId()}))?t:[].concat(Object(c.a)(t),[e])}))}),[a]),i=Object(r.useCallback)((function(e){a((function(t){return t.filter((function(t){return e.getId()!==t.getId()}))}))}),[a]);return[n,o,i]},I=function(){var e,t,n,r=document.location.search.length>1?y.a.parse(document.location.search.slice(1)):{};return{room:null!==(e=r.room)&&void 0!==e?e:"daily_standup",domain:null!==(t=r.domain)&&void 0!==t?t:"meet.jit.si",autoJoin:null!==(n=r.autojoin)&&void 0!==n&&n}};var N=function(){J();var e=Object(r.useMemo)(I,[]),t=Object(r.useState)("init"),n=Object(u.a)(t,2),o=n[0],i=n[1],c=Object(r.useState)(e.domain),s=Object(u.a)(c,2),f=s[0],m=s[1],h=Object(r.useState)(e.room),v=Object(u.a)(h,2),p=v[0],g=v[1],w=Object(r.useState)(null),E=Object(u.a)(w,2),k=E[0],y=E[1],S=x(),C=Object(u.a)(S,3),M=C[0],N=C[1],D=C[2],L=x(),A=Object(u.a)(L,3),_=A[0],z=A[1],R=A[2],H=Object(r.useCallback)((function(e){"video"===e.getType()&&N(e),"audio"===e.getType()&&z(e)}),[N,z]),P=Object(r.useCallback)((function(e){"video"===e.getType()&&D(e),"audio"===e.getType()&&R(e)}),[R,D]),q=Object(r.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),i("loading"),e.next=4,T({domain:f,room:p});case 4:n=e.sent,n.connection,r=n.conference,a=n.localTrack,i("started"),y(r),H(a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[H,f,p]);return Object(r.useEffect)((function(){k&&(k.on(JitsiMeetJS.events.conference.TRACK_ADDED,H),k.on(JitsiMeetJS.events.conference.TRACK_REMOVED,P))}),[H,k,P]),Object(r.useEffect)((function(){(e.autoJoin||""===e.autoJoin)&&q()}),[q,e.autoJoin]),a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},"init"===o&&a.a.createElement(j,{connect:q,domain:f,room:p,setRoom:g,setDomain:m}),"loading"===o&&"Loading","started"===o&&a.a.createElement("div",{style:{height:"100vh",width:"100vw",maxHeight:"100vw",maxWidth:"100vh",background:"rgba(0, 100,100, 1)",position:"relative",borderRadius:"100%"}},M.map((function(e,t){return a.a.createElement(b,{track:e,index:t,length:M.length,key:e.getId()})})),_.map((function(e,t){return a.a.createElement(O,{track:e,index:t,key:e.getId()})})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[50,1,2]]]);
//# sourceMappingURL=main.315f591e.chunk.js.map